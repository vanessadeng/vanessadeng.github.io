<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="x5-fullscreen" content="true">
<meta name="full-screen" content="yes">
<meta name="theme-color" content="#317EFB" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=0" name="viewport">
<meta name="description" content="SQL QUERY OPTIMIZATION TECHNIQUESSQL Query optimization is the process of choosing the most efficient means of executing an SQL statement and is an essential component of any application as it can im">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL QUERY OPTIMIZATION TIPS">
<meta property="og:url" content="https://vanessadeng.4everland.app/2024/03/28/sql-query-optimization%20copy/index.html">
<meta property="og:site_name" content="Vanessa Deng Blog">
<meta property="og:description" content="SQL QUERY OPTIMIZATION TECHNIQUESSQL Query optimization is the process of choosing the most efficient means of executing an SQL statement and is an essential component of any application as it can im">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://vanessadeng.4everland.app/img/404.jpg">
<meta property="article:published_time" content="2024-03-28T22:23:40.000Z">
<meta property="article:modified_time" content="2024-03-28T09:47:53.867Z">
<meta property="article:author" content="Vanessa Deng">
<meta property="article:tag" content="backend">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://vanessadeng.4everland.app/img/404.jpg">

    <meta name="keywords" content="database, sql">


<title >SQL QUERY OPTIMIZATION TIPS</title>

<!-- Favicon -->

    <link href='/img/favicon.svg?v=2.1.10' rel='icon' type='image/png' sizes='16x16' ></link>


    <link href='/img/favicon.svg?v=2.1.10' rel='icon' type='image/png' sizes='32x32' ></link>




<!-- Plugin -->




    
<link rel="stylesheet" href="/css/plugins/bootstrap.row.css">

    
<link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.css">

    
    




<!-- Icon -->

    
<link rel="stylesheet" href="/css/plugins/font-awesome.min.css">




<!-- Variable -->
<script>window.ASYNC_CONFIG = {"hostname":"vanessadeng.4everland.app","author":"Vanessa Deng","root":"/","typed_text":["deng.xuey@northeastern.edu"],"theme_version":"2.1.10","theme":{"switch":false,"default":"style-light"},"favicon":{"logo":"/img/favicon.svg","icon16":"/img/favicon.svg","icon32":"/img/favicon.svg","appleTouchIcon":null,"webmanifest":null,"visibilitychange":false,"hidden":"/failure.ico","showText":"(/≧▽≦/)Hey! Good again!","hideText":"(●—●)Oh, crash!"},"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}.","hits":"${hits} results found","hits_time":"${hits} results found in ${time} ms","author":"Post author: ","copyright_link":"Post link: ","copyright_license_title":"Copyright Notice: ","copyright_license_content":"All articles in this blog are licensed under undefined unless otherwise stated.","copy_success":"Copied","copy_failure":"Copy failed","open_read_mode":"Enter reading mode","exit_read_mode":"Exit reading mode","notice_outdate_message":"It has been undefined days since the last update, the content of the article may be outdated.","sticky":"TOP","just":"Just","min":"minutes ago","hour":"hours ago","day":"days ago","month":"months ago"},"swup":false,"plugin":{"flickr_justified_gallery":"https://unpkg.com/flickr-justified-gallery@latest/dist/fjGallery.min.js"},"icons":{"sun":"far fa-sun","moon":"far fa-moon","play":"fas fa-play","email":"far fa-envelope","next":"fas fa-arrow-right","calendar":"far fa-calendar-alt","clock":"far fa-clock","user":"far fa-user","back_top":"fas fa-arrow-up","close":"fas fa-times","search":"fas fa-search","reward":"fas fa-hand-holding-usd","user_tag":"fas fa-user-alt","toc_tag":"fas fa-th-list","read":"fas fa-book-reader","arrows":"fas fa-arrows-alt-h","double_arrows":"fas fa-angle-double-down","copy":"fas fa-copy"},"icontype":"font","highlight":{"plugin":"highlighjs","theme":true,"copy":true,"lang":true,"title":"mac","height_limit":false},"toc":{"post_title":true},"live_time":{"start_time":"","prefix":"The blog has been lovely to run undefined day"}};</script>
<script id="async-page-config">window.PAGE_CONFIG = {"isPost":true,"isHome":false,"postUpdate":"2024-03-28 02:47:53"};</script>

<!-- Theme mode css -->
<link data-swup-theme rel="stylesheet" href="/css/index.css?v=2.1.10" id="trm-switch-style">
<script>
    let defaultMode = ASYNC_CONFIG.theme.default !=='auto' ?  ASYNC_CONFIG.theme.default : (window.matchMedia("(prefers-color-scheme: light)").matches ? 'style-light' : 'style-dark')
    let catchMode = localStorage.getItem('theme-mode') || defaultMode;
    let type = catchMode === 'style-dark' ? 'add' : 'remove';
    document.documentElement.classList[type]('dark')
</script>

<!-- CDN -->


    
    



<!-- Site Analytics -->
 
<meta name="generator" content="Hexo 7.1.1"></head>

<body>

  <!-- app wrapper -->
  <div class="trm-app-frame">

    <!-- page preloader -->
    <div class="trm-preloader">
    <div class="trm-holder">
        <div class="preloader">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
    <!-- page preloader end -->

    <!-- change mode preloader -->
    <div class="trm-mode-swich-animation-frame">
    <div class="trm-mode-swich-animation">
        <i class="i-sun"><i class="iconfont far fa-sun"></i></i>
        <div class="trm-horizon"></div>
        <i class="i-moon"><i class="iconfont far fa-moon"></i></i>
    </div>
</div>
    <!-- change mode preloader end -->

      <!-- scroll container -->
      <div id="trm-dynamic-content" class="trm-swup-animation">
        <div id="trm-scroll-container" class="trm-scroll-container" style="opacity: 0">
            <!-- top bar -->
            <header class="trm-top-bar">
	<div class="container">
		<div class="trm-left-side">
			<!-- logo -->
<a href="/" class="trm-logo-frame trm-anima-link">
    
        <img alt="logo" src="/img/favicon.svg">
    
    
</a>
<!-- logo end -->
		</div>
		<div class="trm-right-side">
			<!-- menu -->
<div class="trm-menu">
    <nav>
        <ul>
            
            <li class="menu-item-has-children ">
                <a  href="/" target="">
                    main
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/tags/" target="">
                    archives
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/links/" target="">
                    external link
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/projects/" target="">
                    my projects
                </a>
                
            </li>
            
            <li class="menu-item-has-children ">
                <a  href="/about/" target="">
                    about
                </a>
                
            </li>
            
        </ul>
    </nav>
</div>
<!-- menu end -->
			
			
		</div>
		<div class="trm-menu-btn">
			<span></span>
		</div>
	</div>
</header>
            <!-- top bar end -->

            <!-- body -->
            
<div class="trm-content-start">
    <!-- banner -->
    <div class="trm-banner">
    
    <!-- banner video cover -->
    <video autoplay="autoplay" loop muted playsinline webkit-playinginline class="trm-banner-cover">
        <source src="/tx/5.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
        Your browser does not support HTML5 video.
    </video>
    <!-- banner video cover end -->
    

    <!-- banner content -->
    <div class="trm-banner-content trm-overlay">
        <div class="container">
            <div class="row">
                
                <div class="col-lg-4"></div>
                
                <div class="col-lg-8">

                    <!-- banner title -->
                    <div class="trm-banner-text ">
                        <div class="trm-label trm-mb-20">
                            NEWS LETTER
                        </div>
                        <h1 class="trm-mb-30 trm-hsmb-font">
                            SQL QUERY OPTIMIZATION TIPS
                        </h1>

                        
                            <ul class="trm-breadcrumbs trm-label">
                                <li>
                                    <a href="/" class="trm-anima-link">Home</a>
                                </li>
                                <li>
                                    <span>
                                        2024
                                    </span>
                                </li>
                            </ul>
                        
                    </div>
                    <!-- banner title end -->

                    <!-- scroll hint -->
                    <span id="scroll-triger" class="trm-scroll-hint-frame">
                        <div class="trm-scroll-hint"></div>
                        <span class="trm-label">Scroll down</span>
                    </span>
                    <!-- scroll hint end -->

                </div>
            </div>
        </div>
    </div>
    <!-- banner content end -->
</div>
    <!-- banner end -->
    <div class="container">
        <div class="row">
            
                <div class="trm-page-sidebar col-lg-4 hidden-sm">
                    <!-- main card -->
                    <div class="trm-main-card-frame trm-sidebar">
    <div class="trm-main-card"> 
        <!-- card header -->
<div class="trm-mc-header">
    <div class="trm-avatar-frame trm-mb-20">
        <img alt="Avatar" class="trm-avatar" src="/img/avatar.jpg">
    </div>
    <h5 class="trm-name trm-mb-15">
        Vanessa Deng
    </h5>
    
        <div class="trm-label">
            
            <span class="trm-typed-text">
                <!-- Words for theme.user.typedText -->
            </span>
        </div>
    
</div>
<!-- card header end -->
        <!-- sidebar social -->

<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<div class="trm-social">
    
        <a href="https://github.com/vanessadeng" title="Github" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-github"></i>
        </a>
    
        <a href="https://www.linkedin.com/in/xueyuandeng/" title="linkedin" rel="nofollow" target="_blank">
            <i class="iconfont fab fa-linkedin"></i>
        </a>
    
</div>

<!-- sidebar social end -->
        <!-- info -->
<div class="trm-divider trm-mb-40 trm-mt-40"></div>
<ul class="trm-table trm-mb-20">
    
        <li>
            <div class="trm-label">
                current address:
            </div>
            <div class="trm-label trm-label-light">
                seattle, WA, US
            </div>
        </li>
    
</ul>
<!-- info end -->

        
    <div class="trm-divider trm-mb-40 trm-mt-40"></div>
    <!-- action button -->
    <div class="text-center">
        <a href="mailto:deng.xuey@northeastern.edu" class="trm-btn">
            Contact Me
            <i class="iconfont far fa-envelope"></i>
        </a>
    </div>
    <!-- action button end -->

    </div>
</div>
                    <!-- main card end -->
                </div>
            
            <div class="trm-page-content col-lg-8">
                <div id="trm-content" class="trm-content">
                    <div class="trm-post-info row hidden-sm">
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-calendar-alt trm-icon"></i><br>
            03/28
        </div>
    </div>
    <div class="col-sm-4">
        <div class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-clock trm-icon"></i><br>
            15:23
        </div>
    </div>
    <div class="col-sm-4">
        <div id="post-author" class="trm-card trm-label trm-label-light text-center">
            <i class="iconfont far fa-user trm-icon"></i><br>
            Vanessa Deng
        </div>
    </div>
</div>
<div class="trm-card ">
    <article id="article-container" class="trm-publication">
    <p><img src="https://azurecomcdn.azureedge.net/cvt-7a1caae261bd8b84c6eea4a6d655fb0f72c5bad2c994b89e12fa57f965ffefca/images/page/products/azure-sql/database/image-value-prop-1.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h2 id="SQL-QUERY-OPTIMIZATION-TECHNIQUES"><a href="#SQL-QUERY-OPTIMIZATION-TECHNIQUES" class="headerlink" title="SQL QUERY OPTIMIZATION TECHNIQUES"></a>SQL QUERY OPTIMIZATION TECHNIQUES</h2><p>SQL Query optimization is the process of choosing the most efficient means of executing an SQL statement and is an essential component of any application as it can improve the user experience.</p>
<p>Even slight changes in SQL queries can improve performance drastically and over time I have employed a few best practices which have helped me improve query performance and hope these will help anyone who is looking to write performant queries.</p>
<h3 id="Prefer-UNION-ALL-to-UNION"><a href="#Prefer-UNION-ALL-to-UNION" class="headerlink" title="Prefer UNION ALL to UNION"></a>Prefer UNION ALL to UNION</h3><p>If duplicates are not an issue, UNION ALL won’t discard them, and since UNION ALL isn’t tasked with removing duplicates, the query will be more efficient.</p>
<h3 id="Use-TRUNCATE-instead-of-DELETE-to-delete-all-rows-in-a-table"><a href="#Use-TRUNCATE-instead-of-DELETE-to-delete-all-rows-in-a-table" class="headerlink" title="Use TRUNCATE instead of DELETE to delete all rows in a table"></a>Use TRUNCATE instead of DELETE to delete all rows in a table</h3><p>The TRUNCATE statement removes all rows from a table by dropping the table and recreating a new table with the same name. This performs better than using DELETE, which performs multiple transactions to delete all rows.</p>
<h3 id="Drop-index-before-loading-bulk-data"><a href="#Drop-index-before-loading-bulk-data" class="headerlink" title="Drop index before loading bulk data"></a>Drop index before loading bulk data</h3><p>Inserting thousands of rows into a table having an index slows down the ingestion of data.</p>
<p>In such cases it’s preferable to drop indexes before loading the table. Once the load is done, recreate the indexes on the table.</p>
<h3 id="Avoid-too-many-subquery-or-CTE-joins"><a href="#Avoid-too-many-subquery-or-CTE-joins" class="headerlink" title="Avoid too many subquery or CTE joins"></a>Avoid too many subquery or CTE joins</h3><p>Joining many subqueries or CTE’s might lead to holding all the rows in memory and requires constant spilling of data to disk in order to facilitate the join operation and it takes a long time to finish the query.</p>
<p>A solution to this is to load the data or all the subqueries&#x2F;CTE’s into intermediate&#x2F;temp tables and then use those tables to do the join, as this doesn’t involve holding in memory and uses the pre-computed data available in disk via the intermediate&#x2F;temp tables to compute the query.</p>
<p>This was something which helped me cut down the query execution time from 7+ hours to just 10 mins. That’s just ridiculous !!!!!</p>
<h3 id="Use-Data-Compression-Whenever-Possible"><a href="#Use-Data-Compression-Whenever-Possible" class="headerlink" title="Use Data Compression Whenever Possible"></a>Use Data Compression Whenever Possible</h3><p>This works really well for columnar data warehouses like redshift and snowflake and also row based databases like SQL Server.</p>
<p>A majority of the time, it takes longer to read from the disk subsystem than it does to decompress the data. If the bottleneck is at the I&#x2F;O level, using compression helps reducing the size of the table or index on the disk and speeds up the query execution.</p>
<h3 id="Use-Same-Datatype-on-JOIN-and-WHERE-Clauses"><a href="#Use-Same-Datatype-on-JOIN-and-WHERE-Clauses" class="headerlink" title="Use Same Datatype on JOIN and WHERE Clauses"></a>Use Same Datatype on JOIN and WHERE Clauses</h3><p>When joining or comparing two fields with different datatypes, SQL must do an on-the-fly conversion of the field before it can do a comparison, even if the fields are indexed which requires resources and might reduce performance. If mismatched datatypes are unavoidable, try to cast the larger datatype to the smaller datatype whenever possible.</p>
<h3 id="Make-sure-your-queries-take-advantage-of-INDEXING"><a href="#Make-sure-your-queries-take-advantage-of-INDEXING" class="headerlink" title="Make sure your queries take advantage of INDEXING"></a>Make sure your queries take advantage of INDEXING</h3><p>One of the most common things folks run into when experiencing performance issues with database queries is a lack of adequate indexing.</p>
<p>Which columns you should index usually depends on the columns you’re filtering by (i.e., which columns typically end up in your WHERE clauses). If you find that you’re always filtering by a common set of columns, you should consider indexing those columns.</p>
<h3 id="Avoid-correlated-subqueries-unless-required"><a href="#Avoid-correlated-subqueries-unless-required" class="headerlink" title="Avoid correlated subqueries unless required"></a>Avoid correlated subqueries unless required</h3><p>A correlated subquery depends on the outer query. Since it executes row by row, it decreases the overall speed of the process.</p>
<h3 id="Use-Equals-Operator-instead-of-LIKE-clause"><a href="#Use-Equals-Operator-instead-of-LIKE-clause" class="headerlink" title="Use Equals Operator (&#x3D;) instead of LIKE clause"></a>Use Equals Operator (&#x3D;) instead of LIKE clause</h3><p>‘&#x3D;’ and LIKE clauses are used to match rows having a particular value. The main difference between the two is that the LIKE operator is used for matching wildcards such as % to search for partial strings, whereas the equals operator “&#x3D;” looks for exact matches.</p>
<p>If you have to choose between the two, always prefer the equals operator (“&#x3D;”), as it makes use of indexed columns which makes it faster in searching through the value, but if the search requirement is about searching on a particular pattern then LIKE can be used.</p>
<h3 id="Avoid-concatenation-of-columns-in-WHERE-clause"><a href="#Avoid-concatenation-of-columns-in-WHERE-clause" class="headerlink" title="Avoid concatenation of columns in WHERE clause"></a>Avoid concatenation of columns in WHERE clause</h3><p>Avoid concatenation in WHERE clause whenever possible. You should Avoid concatenating multiple columns in WHERE clause. If there is concatenation, break the query into multiple conditions.</p>

</article>
    
    

</div>
<div class="trm-post-next-prev row">
    <div class="col-lg-12">
        <!-- title -->
        <h5 class="trm-title-with-divider">
            Other Articles
            <span data-number="02"></span>
        </h5>
    </div>
    
        <div class="col-lg-6">
    <div class="trm-blog-card trm-scroll-animation">
        <a href="/2024/03/31/java-fundamental-notes/" class="trm-cover-frame trm-anima-link">
            
            
                <img alt="cover" class="no-fancybox" src="https://img2.baidu.com/it/u=4079504166,1443654165&fm=253&fmt=auto&app=138&f=JPEG?w=667&h=500">
            
        </a>
        
        <div class="trm-card-descr">
            <div class="trm-label trm-category trm-mb-20">
                <a href=" /categories/backend/">
                    backend
                </a>
            </div>
            <h5>
                <a href="/2024/03/31/java-fundamental-notes/" class="trm-anima-link">
                    JAVA FUNDAMENTAL NOTES
                </a>
            </h5>
            <div class="trm-divider trm-mb-20 trm-mt-20"></div>
            <ul class="trm-card-data trm-label">
                <li>24/03/31</li>
                <li>15:23</li>
                
                
            </ul>
        </div>
    </div>
</div>
    
    
</div>

    



                    <div class="trm-divider footer-divider"></div>

                    <!-- footer -->
                    <footer class="trm-scroll-animation">

    

    

      

     

     
</footer>
                    <!-- footer end -->

                </div>
            </div>
        </div>
    </div>
</div>
            <!-- body end -->

            

            
<div class="trm-fixed-container">
    
    
        <div class="trm-fixed-btn" data-title="Read Mode" onclick="asyncFun.switchReadMode()">
            <i class="iconfont fas fa-book-reader"></i>
        </div>
    
    
    <div id="trm-back-top" class="trm-fixed-btn" data-title="Back To Top">
        <i class="iconfont fas fa-arrow-up"></i>
    </div>
</div>
        </div>
      </div>
      <!-- scroll container end -->
  </div>
  <!-- app wrapper end -->

  
  <!-- Plugin -->




    
    
<script src="https://unpkg.com/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>

    

    
        <script src="/js/plugins/typing.js?v=2.1.10"></script>
    

    

    <!-- 数学公式 -->
    

    <!-- 评论插件 -->
    
        

        
    



<!-- CDN -->


    

    

    




    <!-- Service Worker -->
    
    <!-- baidu push -->
    


<script id="async-script" src="/js/main.js?v=2.1.10"></script>

</body>

</html>